<html>
<head>
<title>The Ada Program: pasta.adb</title>
<!-- Automatically created by 'sgml2html'. -->
</head>
<body>
<h1>The Ada Program: pasta.adb</h1>
<pre>
<font size=-1>  1</font> <b><font color=#228B22>with</font></b> Text_IO;
<font size=-1>  2</font> <b><font color=#228B22>with</font></b> Direct_IO;
<font size=-1>  3</font> <b><font color=#228B22>procedure</font></b> Pasta <b><font color=#228B22>is</font></b>
<font size=-1>  4</font> 
<font size=-1>  5</font> <b><i><font color=#BB1212>-- This program maintains the warehouse inventory of different pasta varieties.</font></i></b>
<font size=-1>  6</font> 
<font size=-1>  7</font>    <b><i><font color=#BB1212>-- Type for the different transactions</font></i></b>
<font size=-1>  8</font>    <b><font color=#228B22>type</font></b> Transaction_Type <b><font color=#228B22>is</font></b> (Sale, Shipment, New_Pasta, Amount, Total, Done);
<font size=-1>  9</font> 
<font size=-1> 10</font>    <b><i><font color=#BB1212>-- Types for pasta amounts</font></i></b>
<font size=-1> 11</font>    <b><font color=#228B22>subtype</font></b> Warehouse_Pounds <b><font color=#228B22>is</font></b> <font color=#8B008B>Float</font> <b><font color=#228B22>range</font></b> <font color=#008B8B>0.0</font>..<font color=#008B8B>20_000</font>.<font color=#008B8B>0</font>;  <b><i><font color=#BB1212>-- Ten ton maximum</font></i></b>
<font size=-1> 12</font>    <b><font color=#228B22>subtype</font></b> Shipping_Pounds  <b><font color=#228B22>is</font></b> <font color=#8B008B>Float</font> <b><font color=#228B22>range</font></b> <font color=#008B8B>1.0</font>.. <font color=#008B8B>2_000</font>.<font color=#008B8B>0</font>;  <b><i><font color=#BB1212>-- One pound minimum</font></i></b>
<font size=-1> 13</font>                                                            <b><i><font color=#BB1212>-- One ton maximum</font></i></b>
<font size=-1> 14</font> 
<font size=-1> 15</font>    <b><i><font color=#BB1212>-- Instantiations of I/O Packages</font></i></b>
<font size=-1> 16</font>    <b><font color=#228B22>package</font></b> Float_IO       <b><font color=#228B22>is</font></b> <b><font color=#228B22>new</font></b> Text_IO.Float_IO (Num =&#62; <font color=#8B008B>Float</font>);
<font size=-1> 17</font>    <b><font color=#228B22>package</font></b> Integer_IO     <b><font color=#228B22>is</font></b> <b><font color=#228B22>new</font></b> Text_IO.Integer_IO (Num =&#62; <font color=#8B008B>Integer</font>);
<font size=-1> 18</font>    <b><font color=#228B22>package</font></b> Pasta_IO       <b><font color=#228B22>is</font></b> <b><font color=#228B22>new</font></b> Direct_IO (Element_Type =&#62; Warehouse_Pounds);
<font size=-1> 19</font>    <b><font color=#228B22>package</font></b> Transaction_IO <b><font color=#228B22>is</font></b> <b><font color=#228B22>new</font></b> Text_IO.Enumeration_IO (Enum =&#62; Transaction_Type);
<font size=-1> 20</font> 
<font size=-1> 21</font>    <b><i><font color=#BB1212>-- Variables</font></i></b>
<font size=-1> 22</font>    Transaction : Transaction_Type;    <b><i><font color=#BB1212>-- Type of transaction being processed</font></i></b>
<font size=-1> 23</font>    Pasta_File  : Pasta_IO.File_Type;  <b><i><font color=#BB1212>-- Pasta inventory totals</font></i></b>
<font size=-1> 24</font> 
<font size=-1> 25</font> 
<font size=-1> 26</font>    <b><i><font color=#BB1212>--------------------------------------------------------------------</font></i></b>
<font size=-1> 27</font>    <b><font color=#228B22>procedure</font></b> Prepare_File (Pasta_FIle : <b><font color=#228B22>in</font></b> <b><font color=#228B22>out</font></b> Pasta_IO.File_Type) <b><font color=#228B22>is</font></b>
<font size=-1> 28</font> 
<font size=-1> 29</font>    <b><i><font color=#BB1212>-- This procedure prepares the direct access file containing</font></i></b>
<font size=-1> 30</font>    <b><i><font color=#BB1212>-- the company's pasta inventory information</font></i></b>
<font size=-1> 31</font> 
<font size=-1> 32</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 33</font>       Pasta_IO.Open (File =&#62; Pasta_File,
<font size=-1> 34</font>                      Mode =&#62; Pasta_IO.InOut_File,
<font size=-1> 35</font>                      Name =&#62; <font color=#008B8B>"Pasta.Dat"</font>);
<font size=-1> 36</font>    <b><font color=#228B22>exception</font></b>
<font size=-1> 37</font>       <b><font color=#228B22>when</font></b> Pasta_IO.Name_Error =&#62;
<font size=-1> 38</font>          Text_IO.Put_Line (<font color=#008B8B>"Inventory file does not exist"</font>);
<font size=-1> 39</font>          Text_IO.Put_Line (<font color=#008B8B>"Creating the inventory file Pasta.Dat"</font>);
<font size=-1> 40</font>          Pasta_IO.Create (File =&#62; Pasta_File,
<font size=-1> 41</font>                           Mode =&#62; Pasta_IO.InOut_File,
<font size=-1> 42</font>                           Name =&#62; <font color=#008B8B>"Pasta.Dat"</font>);
<font size=-1> 43</font>    <b><font color=#228B22>end</font></b> Prepare_File;
<font size=-1> 44</font> 
<font size=-1> 45</font>    <b><i><font color=#BB1212>-----------------------------------------------------------------</font></i></b>
<font size=-1> 46</font>    <b><font color=#228B22>procedure</font></b> Get_Transaction (Transaction : <b><font color=#228B22>out</font></b> Transaction_Type) <b><font color=#228B22>is</font></b>
<font size=-1> 47</font> 
<font size=-1> 48</font>    <b><i><font color=#BB1212>-- This procedure asks the user what type of transaction they want to</font></i></b>
<font size=-1> 49</font>    <b><i><font color=#BB1212>-- do and gets it from them.  Invalid input is handled.</font></i></b>
<font size=-1> 50</font> 
<font size=-1> 51</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 52</font>       Text_IO.New_Line (<font color=#008B8B>2</font>);
<font size=-1> 53</font>       Text_IO.Put_Line (<font color=#008B8B>"The following operations are available:"</font>);
<font size=-1> 54</font>       Text_IO.Put_Line (<font color=#008B8B>"  Sale      - Update inventory for a shipment out"</font>);
<font size=-1> 55</font>       Text_IO.Put_Line (<font color=#008B8B>"  Shipment  - Update inventory for a shipment in"</font>);
<font size=-1> 56</font>       Text_IO.Put_Line (<font color=#008B8B>"  New_Pasta - Obtain the number for a new pasta"</font>);
<font size=-1> 57</font>       Text_IO.Put_Line (<font color=#008B8B>"  Amount    - Find out the amount of a pasta "</font> &#38;
<font size=-1> 58</font>                                           <font color=#008B8B>"in the inventory"</font>);
<font size=-1> 59</font>       Text_IO.Put_Line (<font color=#008B8B>"  Total     - Find out the total amount of "</font> &#38;
<font size=-1> 60</font>                                           <font color=#008B8B>"pasta in the inventory"</font>);
<font size=-1> 61</font>       Text_IO.Put_Line (<font color=#008B8B>"  Done      - Exit this program"</font>);
<font size=-1> 62</font>       Text_IO.New_Line;
<font size=-1> 63</font>       Input_Loop:  <b><i><font color=#BB1212>-- Each iteration, one input value is checked</font></i></b>
<font size=-1> 64</font>       <b><font color=#228B22>loop</font></b>
<font size=-1> 65</font>          Text_IO.Put (<font color=#008B8B>"Enter your choice:   "</font>);
<font size=-1> 66</font> 
<font size=-1> 67</font>          Validation_Block:  <b><i><font color=#BB1212>-- To handle invalid input values</font></i></b>
<font size=-1> 68</font>          <b><font color=#228B22>begin</font></b>
<font size=-1> 69</font>             Transaction_IO.Get (Transaction);
<font size=-1> 70</font>             <b><font color=#228B22>exit</font></b> Input_Loop;
<font size=-1> 71</font>          <b><font color=#228B22>exception</font></b>
<font size=-1> 72</font>             <b><font color=#228B22>when</font></b> Text_IO.DATA_ERROR =&#62;
<font size=-1> 73</font>                Text_IO.Put_Line (<font color=#008B8B>"Invalid choice, please try again."</font>);
<font size=-1> 74</font>                Text_IO.Skip_Line;    <b><i><font color=#BB1212>-- Skip over bad data</font></i></b>
<font size=-1> 75</font>          <b><font color=#228B22>end</font></b> Validation_Block;
<font size=-1> 76</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>loop</font></b> Input_Loop;
<font size=-1> 77</font>    <b><font color=#228B22>end</font></b> Get_Transaction;
<font size=-1> 78</font> 
<font size=-1> 79</font>    <b><i><font color=#BB1212>--------------------------------------------------------------------------</font></i></b>
<font size=-1> 80</font>    <b><font color=#228B22>procedure</font></b> Process_Transaction
<font size=-1> 81</font>          (Which_Transaction : <b><font color=#228B22>in</font></b>     Transaction_Type;      <b><i><font color=#BB1212>-- Which kind</font></i></b>
<font size=-1> 82</font>           Inventory_File    : <b><font color=#228B22>in</font></b> <b><font color=#228B22>out</font></b> Pasta_IO.File_Type) <b><font color=#228B22>is</font></b> <b><i><font color=#BB1212>-- Inventory file</font></i></b>
<font size=-1> 83</font> 
<font size=-1> 84</font>    <b><i><font color=#BB1212>-- This procedure carries out the appropriate actions for the given</font></i></b>
<font size=-1> 85</font>    <b><i><font color=#BB1212>-- type of transaction.</font></i></b>
<font size=-1> 86</font> 
<font size=-1> 87</font>       <b><i><font color=#BB1212>-------------------------------------------------------------------------</font></i></b>
<font size=-1> 88</font>       <b><font color=#228B22>procedure</font></b> Get_Pasta_ID
<font size=-1> 89</font>             (Max_Value    : <b><font color=#228B22>in</font></b>  <font color=#8B008B>Natural</font>;     <b><i><font color=#BB1212>-- The largest possible ID</font></i></b>
<font size=-1> 90</font>              Pasta_Number : <b><font color=#228B22>out</font></b> <font color=#8B008B>Natural</font>) <b><font color=#228B22>is</font></b>  <b><i><font color=#BB1212>-- The ID of the desired pasta</font></i></b>
<font size=-1> 91</font> 
<font size=-1> 92</font>       <b><i><font color=#BB1212>-- This procedure prompts for and gets a valid pasta</font></i></b>
<font size=-1> 93</font>       <b><i><font color=#BB1212>-- identification number.  An active test is needed to</font></i></b>
<font size=-1> 94</font>       <b><i><font color=#BB1212>-- check the upper limit of valid pasta numbers.</font></i></b>
<font size=-1> 95</font> 
<font size=-1> 96</font>          Pasta_ID : <font color=#8B008B>Natural</font>;  <b><i><font color=#BB1212>-- A pasta ID number</font></i></b>
<font size=-1> 97</font> 
<font size=-1> 98</font>       <b><font color=#228B22>begin</font></b>
<font size=-1> 99</font>          Validation_Loop:  <b><i><font color=#BB1212>-- Each iteration, one input value is checked</font></i></b>
<font size=-1>100</font>          <b><font color=#228B22>loop</font></b>
<font size=-1>101</font>             Text_IO.Put (<font color=#008B8B>"Enter the Pasta Identification Number:  "</font>);
<font size=-1>102</font>             Validation_Block:
<font size=-1>103</font>             <b><font color=#228B22>begin</font></b>
<font size=-1>104</font>                Integer_IO.Get (Pasta_ID);
<font size=-1>105</font>                Pasta_Number := Pasta_ID;   <b><i><font color=#BB1212>-- Assign value to out parameter</font></i></b>
<font size=-1>106</font>                <b><font color=#228B22>exit</font></b> Validation_Loop <b><font color=#228B22>when</font></b>  Pasta_ID &#62; <font color=#008B8B>0</font> <b><font color=#228B22>and</font></b>
<font size=-1>107</font>                                           Pasta_ID &#60;= Max_Value;
<font size=-1>108</font>                Text_IO.Put_Line (<font color=#008B8B>"Invalid number."</font>);
<font size=-1>109</font>                Text_IO.Put (<font color=#008B8B>"Pasta number must be between 1 and "</font>);
<font size=-1>110</font>                Integer_IO.Put (Item =&#62; Max_Value, Width =&#62; <font color=#008B8B>1</font>);
<font size=-1>111</font>                Text_IO.New_Line;
<font size=-1>112</font>             <b><font color=#228B22>exception</font></b>
<font size=-1>113</font>                <b><font color=#228B22>when</font></b> Text_IO.DATA_ERROR =&#62;
<font size=-1>114</font>                   Text_IO.Put_Line (<font color=#008B8B>"Invalid number.  "</font>);
<font size=-1>115</font>                   Text_IO.Skip_Line;  <b><i><font color=#BB1212>-- Skip over bad data</font></i></b>
<font size=-1>116</font>                <b><font color=#228B22>when</font></b> CONSTRAINT_ERROR =&#62;
<font size=-1>117</font>                   Text_IO.Put_Line (<font color=#008B8B>"Invalid number.  "</font>);
<font size=-1>118</font>                   Text_IO.Put (<font color=#008B8B>"Pasta number must be between 1 and "</font>);
<font size=-1>119</font>                   Integer_IO.Put (Item =&#62; Max_Value, Width =&#62; <font color=#008B8B>1</font>);
<font size=-1>120</font>                   Text_IO.New_Line;
<font size=-1>121</font>             <b><font color=#228B22>end</font></b> Validation_Block;
<font size=-1>122</font>          <b><font color=#228B22>end</font></b> <b><font color=#228B22>loop</font></b> Validation_Loop;
<font size=-1>123</font>       <b><font color=#228B22>end</font></b> Get_Pasta_ID;
<font size=-1>124</font> 
<font size=-1>125</font>       <b><i><font color=#BB1212>-------------------------------------------------------------------------</font></i></b>
<font size=-1>126</font>       <b><font color=#228B22>procedure</font></b> Get_Pounds (Amount : <b><font color=#228B22>out</font></b> Shipping_Pounds) <b><font color=#228B22>is</font></b>  <b><i><font color=#BB1212>-- Pounds of Pasta</font></i></b>
<font size=-1>127</font> 
<font size=-1>128</font>       <b><i><font color=#BB1212>-- This procedure prompts for and gets a valid weight</font></i></b>
<font size=-1>129</font>       <b><i><font color=#BB1212>-- of a pasta shipment</font></i></b>
<font size=-1>130</font> 
<font size=-1>131</font>       <b><font color=#228B22>begin</font></b>
<font size=-1>132</font>          Validation_Loop:  <b><i><font color=#BB1212>-- Each iteration, one input value is checked</font></i></b>
<font size=-1>133</font>          <b><font color=#228B22>loop</font></b>
<font size=-1>134</font>             Text_IO.Put (<font color=#008B8B>"Enter the amount (pounds) of pasta in shipment:  "</font>);
<font size=-1>135</font>             Validation_Block:
<font size=-1>136</font>             <b><font color=#228B22>begin</font></b>
<font size=-1>137</font>                Float_IO.Get (Amount);
<font size=-1>138</font>                <b><font color=#228B22>exit</font></b> Validation_Loop;
<font size=-1>139</font>             <b><font color=#228B22>exception</font></b>
<font size=-1>140</font>                <b><font color=#228B22>when</font></b> Text_IO.DATA_ERROR =&#62;
<font size=-1>141</font>                   Text_IO.Put_Line (<font color=#008B8B>"Invalid amount."</font>);
<font size=-1>142</font>                   Text_IO.Put_Line (<font color=#008B8B>"Enter a number that includes a decimal point "</font>);
<font size=-1>143</font>                   Text_IO.Put_Line (<font color=#008B8B>"with at least one digit on each side."</font>);
<font size=-1>144</font>                   Text_IO.Skip_Line;  <b><i><font color=#BB1212>-- Skip over bad data</font></i></b>
<font size=-1>145</font>                <b><font color=#228B22>when</font></b> CONSTRAINT_ERROR =&#62;
<font size=-1>146</font>                   Text_IO.Put_Line (<font color=#008B8B>"Invalid amount."</font>);
<font size=-1>147</font>                   Text_IO.Put (<font color=#008B8B>"Enter a number between "</font>);
<font size=-1>148</font>                   Float_IO.Put (Item =&#62; Shipping_Pounds<font color=#8B008B>'First</font>,
<font size=-1>149</font>                                 Fore =&#62; <font color=#008B8B>1</font>,
<font size=-1>150</font>                                 Aft  =&#62; <font color=#008B8B>1</font>,
<font size=-1>151</font>                                 Exp  =&#62; <font color=#008B8B>0</font>);
<font size=-1>152</font>                   Text_IO.Put (<font color=#008B8B>" and "</font>);
<font size=-1>153</font>                   Float_IO.Put (Item =&#62; Shipping_Pounds<font color=#8B008B>'Last</font>,
<font size=-1>154</font>                                 Fore =&#62; <font color=#008B8B>1</font>,
<font size=-1>155</font>                                 Aft  =&#62; <font color=#008B8B>1</font>,
<font size=-1>156</font>                                 Exp  =&#62; <font color=#008B8B>0</font>);
<font size=-1>157</font>                   Text_IO.New_Line;
<font size=-1>158</font>             <b><font color=#228B22>end</font></b> Validation_Block;
<font size=-1>159</font>          <b><font color=#228B22>end</font></b> <b><font color=#228B22>loop</font></b> Validation_Loop;
<font size=-1>160</font>       <b><font color=#228B22>end</font></b> Get_Pounds;
<font size=-1>161</font> 
<font size=-1>162</font>       <b><i><font color=#BB1212>-----------------------------------------------------------------</font></i></b>
<font size=-1>163</font>       <b><font color=#228B22>procedure</font></b> Process_Sale (Pasta_File : <b><font color=#228B22>in</font></b> <b><font color=#228B22>out</font></b> Pasta_IO.File_Type) <b><font color=#228B22>is</font></b>
<font size=-1>164</font> 
<font size=-1>165</font>       <b><i><font color=#BB1212>-- This procedure gets sales information from the user and subtracts</font></i></b>
<font size=-1>166</font>       <b><i><font color=#BB1212>-- the amount of pasta sold from the inventory.</font></i></b>
<font size=-1>167</font> 
<font size=-1>168</font>          Pasta_Number : <font color=#8B008B>Natural</font>;          <b><i><font color=#BB1212>-- The pasta identification number</font></i></b>
<font size=-1>169</font>          Amount       : Shipping_Pounds;  <b><i><font color=#BB1212>-- The amount of pasta sold and shipped</font></i></b>
<font size=-1>170</font>          Total        : Warehouse_Pounds; <b><i><font color=#BB1212>-- The total amount in inventory</font></i></b>
<font size=-1>171</font> 
<font size=-1>172</font>       <b><font color=#228B22>begin</font></b> <b><i><font color=#BB1212>-- Procedure Process_Sale</font></i></b>
<font size=-1>173</font>          <b><i><font color=#BB1212>-- Get the necessary data from the user</font></i></b>
<font size=-1>174</font>             <b><i><font color=#BB1212>-- The maximum legal value of a pasta ID number is the last index</font></i></b>
<font size=-1>175</font>             <b><i><font color=#BB1212>-- Type conversion is necessary for converting Count to Natural</font></i></b>
<font size=-1>176</font>          Get_Pasta_ID (Max_Value    =&#62; <font color=#8B008B>Natural</font> (Pasta_IO.Size (Pasta_File)),
<font size=-1>177</font>                        Pasta_Number =&#62; Pasta_Number);
<font size=-1>178</font>          Get_Pounds (Amount);
<font size=-1>179</font> 
<font size=-1>180</font>          <b><i><font color=#BB1212>-- Update the inventory</font></i></b>
<font size=-1>181</font> 
<font size=-1>182</font>          <b><i><font color=#BB1212>-- Get the total amount in inventory</font></i></b>
<font size=-1>183</font>          <b><i><font color=#BB1212>-- Type conversion is necessary for converting Natural to Count</font></i></b>
<font size=-1>184</font>          Pasta_IO.Read (File =&#62; Pasta_File,
<font size=-1>185</font>                         Item =&#62; Total,
<font size=-1>186</font>                         From =&#62; Pasta_IO.Count (Pasta_Number));
<font size=-1>187</font>          <b><i><font color=#BB1212>-- Calculate the new total</font></i></b>
<font size=-1>188</font>          Total := Total - Amount;
<font size=-1>189</font>          <b><i><font color=#BB1212>-- Put the new total back in the inventory file</font></i></b>
<font size=-1>190</font>          Pasta_IO.Write (File =&#62; Pasta_File,
<font size=-1>191</font>                          Item =&#62; Total,
<font size=-1>192</font>                          To   =&#62; Pasta_IO.Count (Pasta_Number));
<font size=-1>193</font>       <b><font color=#228B22>exception</font></b>
<font size=-1>194</font>          <b><font color=#228B22>when</font></b> CONSTRAINT_ERROR =&#62;   <b><i><font color=#BB1212>-- Negative total</font></i></b>
<font size=-1>195</font>             Text_IO.Put_Line (<font color=#008B8B>"Not enough Pasta in stock for this sale!"</font>);
<font size=-1>196</font>       <b><font color=#228B22>end</font></b> Process_Sale;
<font size=-1>197</font> 
<font size=-1>198</font>       <b><i><font color=#BB1212>-----------------------------------------------------------------</font></i></b>
<font size=-1>199</font>       <b><font color=#228B22>procedure</font></b> Process_Shipment (Pasta_File : <b><font color=#228B22>in</font></b> <b><font color=#228B22>out</font></b> Pasta_IO.File_Type) <b><font color=#228B22>is</font></b>
<font size=-1>200</font> 
<font size=-1>201</font>       <b><i><font color=#BB1212>-- This procedure gets factory production information from the user</font></i></b>
<font size=-1>202</font>       <b><i><font color=#BB1212>-- and adds it to the inventory</font></i></b>
<font size=-1>203</font> 
<font size=-1>204</font>          Pasta_Number : <font color=#8B008B>Natural</font>;          <b><i><font color=#BB1212>-- The pasta identification number</font></i></b>
<font size=-1>205</font>          Amount       : Shipping_Pounds;  <b><i><font color=#BB1212>-- The amount of pasta sold and shipped</font></i></b>
<font size=-1>206</font>          Total        : Warehouse_Pounds; <b><i><font color=#BB1212>-- The total amount in inventory</font></i></b>
<font size=-1>207</font> 
<font size=-1>208</font>       <b><font color=#228B22>begin</font></b> <b><i><font color=#BB1212>-- Procedure Process_Sale</font></i></b>
<font size=-1>209</font>          <b><i><font color=#BB1212>-- Get the necessary data from the user</font></i></b>
<font size=-1>210</font>             <b><i><font color=#BB1212>-- The maximum legal value of a pasta ID number is the last index</font></i></b>
<font size=-1>211</font>             <b><i><font color=#BB1212>-- Type conversion is necessary for converting Count to Natural</font></i></b>
<font size=-1>212</font>          Get_Pasta_ID (Max_Value    =&#62; <font color=#8B008B>Natural</font> (Pasta_IO.Size (Pasta_File)),
<font size=-1>213</font>                        Pasta_Number =&#62; Pasta_Number);
<font size=-1>214</font>          Get_Pounds (Amount);
<font size=-1>215</font> 
<font size=-1>216</font>          <b><i><font color=#BB1212>-- Update the inventory</font></i></b>
<font size=-1>217</font>             <b><i><font color=#BB1212>-- Get the total amount in inventory</font></i></b>
<font size=-1>218</font>             <b><i><font color=#BB1212>-- Type conversion is necessary for converting Natural to Count</font></i></b>
<font size=-1>219</font>          Pasta_IO.Read (File =&#62; Pasta_File,
<font size=-1>220</font>                         Item =&#62; Total,
<font size=-1>221</font>                         From =&#62; Pasta_IO.Count (Pasta_Number));
<font size=-1>222</font>             <b><i><font color=#BB1212>-- Calculate the new total</font></i></b>
<font size=-1>223</font>          Total := Total + Amount;
<font size=-1>224</font>             <b><i><font color=#BB1212>-- Put the new total back in the inventory file</font></i></b>
<font size=-1>225</font>             <b><i><font color=#BB1212>-- Type conversion is necessary for converting Natural to Count</font></i></b>
<font size=-1>226</font>          Pasta_IO.Write (File =&#62; Pasta_File,
<font size=-1>227</font>                          Item =&#62; Total,
<font size=-1>228</font>                          To   =&#62; Pasta_IO.Count (Pasta_Number));
<font size=-1>229</font>       <b><font color=#228B22>exception</font></b>
<font size=-1>230</font>          <b><font color=#228B22>when</font></b> CONSTRAINT_ERROR =&#62;   <b><i><font color=#BB1212>-- Inventory exceeded Warehouse_Weight'Last</font></i></b>
<font size=-1>231</font>             Text_IO.Put_Line (<font color=#008B8B>"Not enough room in warehouse for shipment!"</font>);
<font size=-1>232</font>       <b><font color=#228B22>end</font></b> Process_Shipment;
<font size=-1>233</font> 
<font size=-1>234</font>       <b><i><font color=#BB1212>-----------------------------------------------------------------</font></i></b>
<font size=-1>235</font>       <b><font color=#228B22>procedure</font></b> Process_New (Pasta_File : <b><font color=#228B22>in</font></b> <b><font color=#228B22>out</font></b> Pasta_IO.File_Type) <b><font color=#228B22>is</font></b>
<font size=-1>236</font> 
<font size=-1>237</font>       <b><i><font color=#BB1212>-- This procedure determines and displays a unique identification</font></i></b>
<font size=-1>238</font>       <b><i><font color=#BB1212>-- number for a new pasta variety.  It also initializes the inventory</font></i></b>
<font size=-1>239</font>       <b><i><font color=#BB1212>-- of that variety to zero.</font></i></b>
<font size=-1>240</font> 
<font size=-1>241</font>          New_Pasta_Num : <font color=#8B008B>Natural</font>;  <b><i><font color=#BB1212>-- The ID number for the new variety</font></i></b>
<font size=-1>242</font> 
<font size=-1>243</font>       <b><font color=#228B22>begin</font></b>  <b><i><font color=#BB1212>-- Process New</font></i></b>
<font size=-1>244</font>          <b><i><font color=#BB1212>-- Type conversion is necessary for converting Count to Natural</font></i></b>
<font size=-1>245</font>          New_Pasta_Num := <font color=#8B008B>Natural</font> (Pasta_IO.Size (Pasta_File)) + <font color=#008B8B>1</font>;
<font size=-1>246</font>          Text_IO.New_Line;
<font size=-1>247</font>          Text_IO.Put (<font color=#008B8B>"The number assigned to the new pasta variety is "</font>);
<font size=-1>248</font>          Integer_IO.Put (Item =&#62; New_Pasta_Num,  Width =&#62; <font color=#008B8B>1</font>);
<font size=-1>249</font>          <b><i><font color=#BB1212>-- Type conversion is necessary for converting Natural to Count</font></i></b>
<font size=-1>250</font>          Pasta_IO.Write (File =&#62; Pasta_File,       <b><i><font color=#BB1212>-- Initialize the new pasta's</font></i></b>
<font size=-1>251</font>                          Item =&#62; <font color=#008B8B>0.0</font>,              <b><i><font color=#BB1212>-- inventory to zero</font></i></b>
<font size=-1>252</font>                          To   =&#62; Pasta_IO.Count (New_Pasta_Num));
<font size=-1>253</font>       <b><font color=#228B22>end</font></b> Process_New;
<font size=-1>254</font> 
<font size=-1>255</font>       <b><i><font color=#BB1212>----------------------------------------------------------------------</font></i></b>
<font size=-1>256</font>       <b><font color=#228B22>procedure</font></b> Process_Amount_Query (Pasta_File : <b><font color=#228B22>in</font></b> Pasta_IO.File_Type) <b><font color=#228B22>is</font></b>
<font size=-1>257</font> 
<font size=-1>258</font>       <b><i><font color=#BB1212>-- This procedure displays the amount of a particular pasta in stock</font></i></b>
<font size=-1>259</font> 
<font size=-1>260</font>          Pasta_Number : <font color=#8B008B>Natural</font>;          <b><i><font color=#BB1212>-- The pasta identification number</font></i></b>
<font size=-1>261</font>          Total        : Warehouse_Pounds; <b><i><font color=#BB1212>-- The total amount in inventory</font></i></b>
<font size=-1>262</font> 
<font size=-1>263</font>          <b><font color=#228B22>begin</font></b>  <b><i><font color=#BB1212>-- Process Amount Query</font></i></b>
<font size=-1>264</font>          <b><i><font color=#BB1212>-- Get the necessary data from the user</font></i></b>
<font size=-1>265</font>             <b><i><font color=#BB1212>-- The maximum legal value of a pasta ID number is the last index</font></i></b>
<font size=-1>266</font>          Get_Pasta_ID (Max_Value    =&#62; <font color=#8B008B>Natural</font> (Pasta_IO.Size (Pasta_File)),
<font size=-1>267</font>                        Pasta_Number =&#62; Pasta_Number);
<font size=-1>268</font>          <b><i><font color=#BB1212>-- Get the total amount in inventory</font></i></b>
<font size=-1>269</font>          Pasta_IO.Read (File =&#62; Pasta_File,
<font size=-1>270</font>                         Item =&#62; Total,
<font size=-1>271</font>                         From =&#62; Pasta_IO.Count (Pasta_Number));
<font size=-1>272</font>          <b><i><font color=#BB1212>-- Display the total</font></i></b>
<font size=-1>273</font>          Text_IO.Put (<font color=#008B8B>"The amount of that pasta in stock is "</font>);
<font size=-1>274</font>          Float_IO.Put (Item =&#62; Total,
<font size=-1>275</font>                        Fore =&#62; <font color=#008B8B>1</font>,
<font size=-1>276</font>                        Aft  =&#62; <font color=#008B8B>1</font>,
<font size=-1>277</font>                        Exp  =&#62; <font color=#008B8B>0</font>);
<font size=-1>278</font>          Text_IO.Put_Line (<font color=#008B8B>" pounds."</font>);
<font size=-1>279</font>       <b><font color=#228B22>end</font></b> Process_Amount_Query;
<font size=-1>280</font> 
<font size=-1>281</font>       <b><i><font color=#BB1212>---------------------------------------------------------------------</font></i></b>
<font size=-1>282</font>       <b><font color=#228B22>procedure</font></b> Process_Total_Query (Pasta_File : <b><font color=#228B22>in</font></b> Pasta_IO.File_Type) <b><font color=#228B22>is</font></b>
<font size=-1>283</font> 
<font size=-1>284</font>       <b><i><font color=#BB1212>-- This procedure determines and displays the total amount of</font></i></b>
<font size=-1>285</font>       <b><i><font color=#BB1212>-- pasta in the warehouse</font></i></b>
<font size=-1>286</font> 
<font size=-1>287</font>          Total  : <font color=#8B008B>Float</font>;              <b><i><font color=#BB1212>-- The total amount of pasta in stock</font></i></b>
<font size=-1>288</font>          Amount : Warehouse_Pounds;   <b><i><font color=#BB1212>-- The amount of one pasta in stock</font></i></b>
<font size=-1>289</font> 
<font size=-1>290</font>       <b><font color=#228B22>begin</font></b> <b><i><font color=#BB1212>-- Process Total Query</font></i></b>
<font size=-1>291</font>          Total := <font color=#008B8B>0.0</font>;                            <b><i><font color=#BB1212>-- Initialize sum</font></i></b>
<font size=-1>292</font>          Pasta_IO.Set_Index (File =&#62; Pasta_File,  <b><i><font color=#BB1212>-- Initialize file index</font></i></b>
<font size=-1>293</font>                              To   =&#62; <font color=#008B8B>1</font>);
<font size=-1>294</font>          Sum_Loop:   <b><i><font color=#BB1212>-- Each iteration, one pasta variety amount is read and</font></i></b>
<font size=-1>295</font>          <b><font color=#228B22>loop</font></b>        <b><i><font color=#BB1212>-- added to the total</font></i></b>
<font size=-1>296</font>             <b><font color=#228B22>exit</font></b> Sum_Loop <b><font color=#228B22>when</font></b> Pasta_IO.End_Of_File (Pasta_File);
<font size=-1>297</font>             Pasta_IO.Read (File =&#62; Pasta_File,
<font size=-1>298</font>                            Item =&#62; Amount);
<font size=-1>299</font>             Total := Total + Amount;
<font size=-1>300</font>          <b><font color=#228B22>end</font></b> <b><font color=#228B22>loop</font></b> Sum_Loop;
<font size=-1>301</font> 
<font size=-1>302</font>          Text_IO.New_Line;
<font size=-1>303</font>          Text_IO.Put (<font color=#008B8B>"Total amount of pasta in the warehouse is "</font>);
<font size=-1>304</font>          Float_IO.Put (Item =&#62; Total,
<font size=-1>305</font>                        Fore =&#62; <font color=#008B8B>1</font>,
<font size=-1>306</font>                        Aft  =&#62; <font color=#008B8B>1</font>,
<font size=-1>307</font>                        Exp  =&#62; <font color=#008B8B>0</font>);
<font size=-1>308</font>           Text_IO.Put_Line (<font color=#008B8B>" pounds."</font>);
<font size=-1>309</font>       <b><font color=#228B22>end</font></b> Process_Total_Query;
<font size=-1>310</font> 
<font size=-1>311</font>    <b><i><font color=#BB1212>---------------------------------------</font></i></b>
<font size=-1>312</font>    <b><font color=#228B22>begin</font></b> <b><i><font color=#BB1212>-- Procedure Process Transaction</font></i></b>
<font size=-1>313</font>       <b><font color=#228B22>if</font></b> Which_Transaction = Sale <b><font color=#228B22>then</font></b>
<font size=-1>314</font>          Process_Sale (Inventory_File);
<font size=-1>315</font>       <b><font color=#228B22>elsif</font></b> Which_Transaction = Shipment <b><font color=#228B22>then</font></b>
<font size=-1>316</font>          Process_Shipment (Inventory_File);
<font size=-1>317</font>       <b><font color=#228B22>elsif</font></b> Which_Transaction = New_Pasta <b><font color=#228B22>then</font></b>
<font size=-1>318</font>          Process_New (Inventory_File);
<font size=-1>319</font>       <b><font color=#228B22>elsif</font></b> Which_Transaction = Amount <b><font color=#228B22>then</font></b>
<font size=-1>320</font>          Process_Amount_Query (Inventory_File);
<font size=-1>321</font>       <b><font color=#228B22>else</font></b>
<font size=-1>322</font>          Process_Total_Query (Inventory_File);
<font size=-1>323</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1>324</font>    <b><font color=#228B22>end</font></b> Process_Transaction;
<font size=-1>325</font> 
<font size=-1>326</font> <b><i><font color=#BB1212>-----------------------</font></i></b>
<font size=-1>327</font> <b><font color=#228B22>begin</font></b>  <b><i><font color=#BB1212>-- Program Pasta</font></i></b>
<font size=-1>328</font>    Prepare_File (Pasta_File);
<font size=-1>329</font> 
<font size=-1>330</font>    Transaction_Loop:  <b><i><font color=#BB1212>-- Each iteration, one transaction is processed</font></i></b>
<font size=-1>331</font>    <b><font color=#228B22>loop</font></b>
<font size=-1>332</font>       Get_Transaction (Transaction);
<font size=-1>333</font>       <b><font color=#228B22>exit</font></b> Transaction_Loop <b><font color=#228B22>when</font></b> Transaction = Done;
<font size=-1>334</font>       Process_Transaction (Which_Transaction =&#62; Transaction,
<font size=-1>335</font>                            Inventory_File    =&#62; Pasta_File);
<font size=-1>336</font>    <b><font color=#228B22>end</font></b> <b><font color=#228B22>loop</font></b> Transaction_Loop;
<font size=-1>337</font>    <b><i><font color=#BB1212>-- Close the file</font></i></b>
<font size=-1>338</font>    Pasta_IO.Close (Pasta_File);
<font size=-1>339</font> 
<font size=-1>340</font> <b><font color=#228B22>exception</font></b>
<font size=-1>341</font>    <b><font color=#228B22>when</font></b> <b><font color=#228B22>others</font></b> =&#62;                   <b><i><font color=#BB1212>-- If any exception is not handled where</font></i></b>
<font size=-1>342</font>       Pasta_IO.Close (Pasta_File);  <b><i><font color=#BB1212>-- it occurs, close the file and propogate</font></i></b>
<font size=-1>343</font>       <b><font color=#228B22>raise</font></b>;                        <b><i><font color=#BB1212>-- the exception back to the system.</font></i></b>
<font size=-1>344</font> <b><font color=#228B22>end</font></b> Pasta;
</pre>
</body>
</html>
