<html>
<head>
<title>The Ada Program: pizza_2.adb</title>
<!-- Automatically created by 'sgml2html'. -->
</head>
<body>
<h1>The Ada Program: pizza_2.adb</h1>
<pre>
<font size=-1>  1</font> <b><font color=#228B22>with</font></b> <a href="http://www.adahome.com/rm95/rm9x-A-10-01.html">Ada.Text_IO</a>, <a href="http://www.adahome.com/rm95/rm9x-A-10-08.html#20">Ada.Integer_Text_IO</a>;
<font size=-1>  2</font> <b><font color=#228B22>use</font></b> Ada;
<font size=-1>  3</font> 
<font size=-1>  4</font> <b><font color=#228B22>procedure</font></b> Pizza_2 (Constraints: <font color=#8B008B>Positive</font>) <b><font color=#228B22>is</font></b>
<font size=-1>  5</font> 
<font size=-1>  6</font>    <b><font color=#228B22>subtype</font></b> Toppings <b><font color=#228B22>is</font></b> <font color=#8B008B>Character</font> <b><font color=#228B22>range</font></b> <font color=#008B8B>'A'</font> .. <font color=#008B8B>'P'</font>;
<font size=-1>  7</font> 
<font size=-1>  8</font>    <b><font color=#228B22>type</font></b> Request_Type <b><font color=#228B22>is</font></b> <b><font color=#228B22>record</font></b>
<font size=-1>  9</font>       Kind: <font color=#8B008B>Character</font>;
<font size=-1> 10</font>       Topping: Toppings;
<font size=-1> 11</font>    <b><font color=#228B22>end</font></b> <b><font color=#228B22>record</font></b>;
<font size=-1> 12</font> 
<font size=-1> 13</font>    <b><font color=#228B22>type</font></b> Request_Array <b><font color=#228B22>is</font></b> <b><font color=#228B22>array</font></b> (<font color=#8B008B>Positive</font> <b><font color=#228B22>range</font></b> &#60;&#62;) <b><font color=#228B22>of</font></b> Request_Type;
<font size=-1> 14</font>    <b><font color=#228B22>type</font></b> Constraint_Type <b><font color=#228B22>is</font></b> <b><font color=#228B22>access</font></b> Request_Array;
<font size=-1> 15</font> 
<font size=-1> 16</font>    <b><font color=#228B22>subtype</font></b> Index <b><font color=#228B22>is</font></b> <font color=#8B008B>Positive</font> <b><font color=#228B22>range</font></b> <font color=#008B8B>1</font>..Constraints;
<font size=-1> 17</font>    Constraint: <b><font color=#228B22>array</font></b> (Index) <b><font color=#228B22>of</font></b> Constraint_Type :=
<font size=-1> 18</font>       (<b><font color=#228B22>others</font></b> =&#62; <b><font color=#228B22>new</font></b> Request_Array'(<font color=#008B8B>1</font>..<font color=#008B8B>0</font>=&#62; (<font color=#008B8B>'+'</font>,<font color=#008B8B>'A'</font>)));
<font size=-1> 19</font> 
<font size=-1> 20</font>    <b><font color=#228B22>type</font></b> Topping_Set <b><font color=#228B22>is</font></b> <b><font color=#228B22>array</font></b> (Toppings) <b><font color=#228B22>of</font></b> <font color=#8B008B>Boolean</font>;
<font size=-1> 21</font>    Empty_Set: Topping_Set := (<b><font color=#228B22>others</font></b>=&#62;<font color=#8B008B>False</font>);
<font size=-1> 22</font>    <b><font color=#228B22>function</font></b> Is_Member (T: Toppings; S: Topping_Set) <b><font color=#228B22>return</font></b> <font color=#8B008B>Boolean</font> <b><font color=#228B22>is</font></b>
<font size=-1> 23</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 24</font>       <b><font color=#228B22>return</font></b> (S(T));
<font size=-1> 25</font>    <b><font color=#228B22>end</font></b> Is_Member;
<font size=-1> 26</font> 
<font size=-1> 27</font>    <b><font color=#228B22>function</font></b> Add (T: Toppings; S: Topping_Set) <b><font color=#228B22>return</font></b> Topping_Set <b><font color=#228B22>is</font></b>
<font size=-1> 28</font>       R: Topping_Set := S;
<font size=-1> 29</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 30</font>       R(T) := <font color=#8B008B>True</font>;
<font size=-1> 31</font>       <b><font color=#228B22>return</font></b> R;
<font size=-1> 32</font>    <b><font color=#228B22>end</font></b> Add;
<font size=-1> 33</font> 
<font size=-1> 34</font> 
<font size=-1> 35</font>    <b><font color=#228B22>type</font></b> Pizza_Type <b><font color=#228B22>is</font></b> <b><font color=#228B22>record</font></b>
<font size=-1> 36</font>       Has, Holds: Topping_Set := Empty_Set;
<font size=-1> 37</font>    <b><font color=#228B22>end</font></b> <b><font color=#228B22>record</font></b>;
<font size=-1> 38</font> 
<font size=-1> 39</font>    <b><font color=#228B22>procedure</font></b> Put (Pizza: Pizza_Type) <b><font color=#228B22>is</font></b>
<font size=-1> 40</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 41</font>       <b><font color=#228B22>for</font></b> T <b><font color=#228B22>in</font></b> Toppings <b><font color=#228B22>loop</font></b>
<font size=-1> 42</font>          <b><font color=#228B22>if</font></b> Is_Member (T, Pizza.Has) <b><font color=#228B22>then</font></b>
<font size=-1> 43</font>             Text_IO.Put (T);
<font size=-1> 44</font>          <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1> 45</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>loop</font></b>;
<font size=-1> 46</font>       Text_IO.New_Line;
<font size=-1> 47</font>    <b><font color=#228B22>end</font></b> Put;
<font size=-1> 48</font> 
<font size=-1> 49</font>    <b><font color=#228B22>function</font></b> <font color=#008B8B>"&#38;"</font> (A: Request_Array; R: Request_Type) <b><font color=#228B22>return</font></b> Request_Array <b><font color=#228B22>is</font></b>
<font size=-1> 50</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 51</font>       <b><font color=#228B22>return</font></b> (A &#38; Request_Array'(<font color=#008B8B>1</font>..<font color=#008B8B>1</font>=&#62;R));
<font size=-1> 52</font>    <b><font color=#228B22>end</font></b> <font color=#008B8B>"&#38;"</font>;
<font size=-1> 53</font> 
<font size=-1> 54</font>    <b><font color=#228B22>function</font></b> <font color=#008B8B>"&#38;"</font> (A: Constraint_Type; R: Request_Type) <b><font color=#228B22>return</font></b> Constraint_Type <b><font color=#228B22>is</font></b>
<font size=-1> 55</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 56</font>       <b><font color=#228B22>return</font></b> <b><font color=#228B22>new</font></b> Request_Array'(A.<b><font color=#228B22>all</font></b> &#38; R);
<font size=-1> 57</font>    <b><font color=#228B22>end</font></b> <font color=#008B8B>"&#38;"</font>;
<font size=-1> 58</font> 
<font size=-1> 59</font> 
<font size=-1> 60</font>    <b><font color=#228B22>procedure</font></b> Get_Constraint (I: Index) <b><font color=#228B22>is</font></b>
<font size=-1> 61</font>       R: Constraint_Type := <b><font color=#228B22>new</font></b> Request_Array'(<font color=#008B8B>1</font>..<font color=#008B8B>0</font>=&#62;(<font color=#008B8B>'?'</font>,<font color=#008B8B>'A'</font>));
<font size=-1> 62</font>       C,T: <font color=#8B008B>Character</font>;
<font size=-1> 63</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 64</font>       <b><font color=#228B22>loop</font></b>
<font size=-1> 65</font>          Text_IO.Get (C);
<font size=-1> 66</font>          <b><font color=#228B22>exit</font></b> <b><font color=#228B22>when</font></b> C=<font color=#008B8B>';'</font>;
<font size=-1> 67</font>          Text_IO.Get (T);
<font size=-1> 68</font>          R := R &#38; Request_Type'(C,T);
<font size=-1> 69</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>loop</font></b>;
<font size=-1> 70</font>       Constraint (I) := R;
<font size=-1> 71</font>       Text_IO.Skip_Line;
<font size=-1> 72</font>    <b><font color=#228B22>end</font></b> Get_Constraint;
<font size=-1> 73</font> 
<font size=-1> 74</font> 
<font size=-1> 75</font>    Not_Possible: <b><font color=#228B22>exception</font></b>;
<font size=-1> 76</font> 
<font size=-1> 77</font>    <b><font color=#228B22>function</font></b> PosRequest (P: Pizza_Type; T: Toppings) <b><font color=#228B22>return</font></b> Pizza_Type <b><font color=#228B22>is</font></b>
<font size=-1> 78</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 79</font>       <b><font color=#228B22>if</font></b> (Is_Member (T,P.Has)) <b><font color=#228B22>then</font></b>
<font size=-1> 80</font>          <b><font color=#228B22>return</font></b> P;
<font size=-1> 81</font>       <b><font color=#228B22>elsif</font></b> (Is_Member (T,P.Holds)) <b><font color=#228B22>then</font></b>
<font size=-1> 82</font>          <b><font color=#228B22>raise</font></b> Not_Possible;
<font size=-1> 83</font>       <b><font color=#228B22>else</font></b>
<font size=-1> 84</font>          <b><font color=#228B22>return</font></b> (Add (T,P.Has),P.Holds);
<font size=-1> 85</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1> 86</font>    <b><font color=#228B22>end</font></b> PosRequest;
<font size=-1> 87</font> 
<font size=-1> 88</font>    <b><font color=#228B22>function</font></b> NegRequest (P: Pizza_Type; T: Toppings) <b><font color=#228B22>return</font></b> Pizza_Type <b><font color=#228B22>is</font></b>
<font size=-1> 89</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 90</font>       <b><font color=#228B22>if</font></b> (Is_Member (T,P.Holds)) <b><font color=#228B22>then</font></b>
<font size=-1> 91</font>          <b><font color=#228B22>return</font></b> P;
<font size=-1> 92</font>       <b><font color=#228B22>elsif</font></b> (Is_Member (T,P.Has)) <b><font color=#228B22>then</font></b>
<font size=-1> 93</font>          <b><font color=#228B22>raise</font></b> Not_Possible;
<font size=-1> 94</font>       <b><font color=#228B22>else</font></b>
<font size=-1> 95</font>          <b><font color=#228B22>return</font></b> (P.Has, Add (T,P.Holds));
<font size=-1> 96</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1> 97</font>    <b><font color=#228B22>end</font></b> NegRequest;
<font size=-1> 98</font> 
<font size=-1> 99</font>    <b><font color=#228B22>function</font></b> Request (P: Pizza_Type; R: Request_Type) <b><font color=#228B22>return</font></b> Pizza_Type <b><font color=#228B22>is</font></b>
<font size=-1>100</font>    <b><font color=#228B22>begin</font></b>
<font size=-1>101</font>       <b><font color=#228B22>if</font></b> R.Kind=<font color=#008B8B>'+'</font> <b><font color=#228B22>then</font></b>
<font size=-1>102</font>          <b><font color=#228B22>return</font></b> PosRequest(P,R.Topping);
<font size=-1>103</font>       <b><font color=#228B22>else</font></b>
<font size=-1>104</font>          <b><font color=#228B22>return</font></b> NegRequest(P,R.Topping);
<font size=-1>105</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1>106</font>    <b><font color=#228B22>end</font></b> Request;
<font size=-1>107</font> 
<font size=-1>108</font>    <b><font color=#228B22>function</font></b> Search (Pizza: <b><font color=#228B22>in</font></b> Pizza_Type; I: <font color=#8B008B>Natural</font>) <b><font color=#228B22>return</font></b> Pizza_Type <b><font color=#228B22>is</font></b>
<font size=-1>109</font>    <b><font color=#228B22>begin</font></b>
<font size=-1>110</font>       <b><font color=#228B22>for</font></b> J <b><font color=#228B22>in</font></b> Constraint(I)<font color=#8B008B>'Range</font> <b><font color=#228B22>loop</font></b>
<font size=-1>111</font>          <b><font color=#228B22>begin</font></b>
<font size=-1>112</font>             <b><font color=#228B22>if</font></b> I = Index<font color=#8B008B>'Last</font> <b><font color=#228B22>then</font></b>
<font size=-1>113</font>                <b><font color=#228B22>return</font></b> Request (Pizza, Constraint(I)(J));
<font size=-1>114</font>             <b><font color=#228B22>else</font></b>
<font size=-1>115</font>                <b><font color=#228B22>return</font></b> Search (Request (Pizza, Constraint(I)(J)), I+<font color=#008B8B>1</font>);
<font size=-1>116</font>             <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1>117</font>          <b><font color=#228B22>exception</font></b>
<font size=-1>118</font>             <b><font color=#228B22>when</font></b> Not_Possible =&#62; <b><font color=#228B22>null</font></b>;
<font size=-1>119</font>          <b><font color=#228B22>end</font></b>;
<font size=-1>120</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>loop</font></b>;
<font size=-1>121</font>       <b><font color=#228B22>raise</font></b> Not_Possible   ;  <b><i><font color=#BB1212>-- can't satisfy I</font></i></b>
<font size=-1>122</font>    <b><font color=#228B22>end</font></b> Search;
<font size=-1>123</font> 
<font size=-1>124</font>    Pizza: Pizza_Type;
<font size=-1>125</font> 
<font size=-1>126</font> <b><font color=#228B22>begin</font></b>
<font size=-1>127</font>    <b><font color=#228B22>for</font></b> I <b><font color=#228B22>in</font></b> <font color=#008B8B>1</font>..Constraints <b><font color=#228B22>loop</font></b>
<font size=-1>128</font>      Get_Constraint (I);
<font size=-1>129</font>    <b><font color=#228B22>end</font></b> <b><font color=#228B22>loop</font></b>;
<font size=-1>130</font>    Pizza := Search ((Empty_Set, Empty_Set), Index<font color=#8B008B>'First</font>);
<font size=-1>131</font>    Text_IO.Put (<font color=#008B8B>".  Toppings: "</font>);
<font size=-1>132</font>    Put (Pizza);
<font size=-1>133</font> <b><font color=#228B22>exception</font></b>
<font size=-1>134</font>    <b><font color=#228B22>when</font></b> Not_Possible =&#62; Text_IO.Put_Line (<font color=#008B8B>".  No pizza will satisfy everyone."</font>);
<font size=-1>135</font> 
<font size=-1>136</font> <b><font color=#228B22>end</font></b> Pizza_2;
</pre>
</body>
</html>
