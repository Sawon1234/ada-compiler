<html>
<head>
<title>The Ada Program: binary_search_tree.adb</title>
<!-- Automatically created by 'sgml2html'. -->
</head>
<body>
<h1>The Ada Program: binary_search_tree.adb</h1>
<pre>
<font size=-1>  1</font> <b><font color=#228B22>with</font></b> Unchecked_Deallocation;
<font size=-1>  2</font> <b><font color=#228B22>package</font></b> <b><font color=#228B22>body</font></b> Binary_Search_Tree <b><font color=#228B22>is</font></b>
<font size=-1>  3</font> 
<font size=-1>  4</font>    <b><font color=#228B22>procedure</font></b> Free <b><font color=#228B22>is</font></b> <b><font color=#228B22>new</font></b> Unchecked_Deallocation (Node_Type, Node_Ptr);
<font size=-1>  5</font> 
<font size=-1>  6</font>    <b><font color=#228B22>function</font></b> Empty (Tree: Tree_Type) <b><font color=#228B22>return</font></b> <font color=#8B008B>Boolean</font> <b><font color=#228B22>is</font></b>
<font size=-1>  7</font>    <b><font color=#228B22>begin</font></b>
<font size=-1>  8</font>       <b><font color=#228B22>return</font></b> Tree = <b><font color=#228B22>null</font></b>;
<font size=-1>  9</font>    <b><font color=#228B22>end</font></b> Empty;
<font size=-1> 10</font> 
<font size=-1> 11</font>    <b><font color=#228B22>function</font></b> Size (Tree: Tree_Type) <b><font color=#228B22>return</font></b> <font color=#8B008B>Natural</font> <b><font color=#228B22>is</font></b>
<font size=-1> 12</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 13</font>       <b><font color=#228B22>if</font></b> Tree = <b><font color=#228B22>null</font></b> <b><font color=#228B22>then</font></b>
<font size=-1> 14</font>          <b><font color=#228B22>return</font></b> (<font color=#008B8B>0</font>);
<font size=-1> 15</font>       <b><font color=#228B22>else</font></b>
<font size=-1> 16</font>          <b><font color=#228B22>return</font></b> (<font color=#008B8B>1</font> + Size (Tree.Left) + Size (Tree.Right));
<font size=-1> 17</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1> 18</font>    <b><font color=#228B22>end</font></b> Size;
<font size=-1> 19</font> 
<font size=-1> 20</font>    <b><font color=#228B22>procedure</font></b> Clear (Tree : <b><font color=#228B22>in</font></b> <b><font color=#228B22>out</font></b> Tree_Type) <b><font color=#228B22>is</font></b>
<font size=-1> 21</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 22</font>       <b><font color=#228B22>if</font></b> Tree /= <b><font color=#228B22>null</font></b> <b><font color=#228B22>then</font></b>
<font size=-1> 23</font>          Clear (Tree.Left);   <b><i><font color=#BB1212>-- Delete all nodes in the left subtree</font></i></b>
<font size=-1> 24</font>          Clear (Tree.Right);  <b><i><font color=#BB1212>-- Delete all nodes in the right subtree</font></i></b>
<font size=-1> 25</font>          Free (Tree);         <b><i><font color=#BB1212>-- Delete this node</font></i></b>
<font size=-1> 26</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1> 27</font>    <b><font color=#228B22>end</font></b> Clear;
<font size=-1> 28</font> 
<font size=-1> 29</font>    <b><font color=#228B22>procedure</font></b> Insert (Tree: <b><font color=#228B22>in</font></b> <b><font color=#228B22>out</font></b> Tree_Type; Item: <b><font color=#228B22>in</font></b> Element_Type) <b><font color=#228B22>is</font></b>
<font size=-1> 30</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 31</font>       <b><font color=#228B22>if</font></b> Tree = <b><font color=#228B22>null</font></b> <b><font color=#228B22>then</font></b>
<font size=-1> 32</font>          Tree := <b><font color=#228B22>new</font></b> Node_Type'(Info=&#62;Item, Left=&#62;<b><font color=#228B22>null</font></b>, Right=&#62;<b><font color=#228B22>null</font></b>);
<font size=-1> 33</font>       <b><font color=#228B22>elsif</font></b> Key_Of (Item) = Key_Of (Tree.Info) <b><font color=#228B22>then</font></b>
<font size=-1> 34</font>          <b><font color=#228B22>raise</font></b> Duplicate_Key;
<font size=-1> 35</font>       <b><font color=#228B22>elsif</font></b> Key_of (Item) &#60; Key_Of (Tree.Info) <b><font color=#228B22>then</font></b>
<font size=-1> 36</font>          Insert (Tree =&#62; Tree.Left, Item =&#62; Item);
<font size=-1> 37</font>       <b><font color=#228B22>else</font></b>
<font size=-1> 38</font>          Insert (Tree =&#62; Tree.Right, Item =&#62; Item);
<font size=-1> 39</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1> 40</font>    <b><font color=#228B22>end</font></b> Insert;
<font size=-1> 41</font> 
<font size=-1> 42</font> 
<font size=-1> 43</font>    <b><font color=#228B22>procedure</font></b> Modify (Tree    : <b><font color=#228B22>in</font></b> <b><font color=#228B22>out</font></b> Tree_Type;
<font size=-1> 44</font>                      Element : <b><font color=#228B22>in</font></b>     Element_Type) <b><font color=#228B22>is</font></b>
<font size=-1> 45</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 46</font>       <b><font color=#228B22>if</font></b> Tree = <b><font color=#228B22>null</font></b> <b><font color=#228B22>then</font></b>
<font size=-1> 47</font>          <b><font color=#228B22>raise</font></b> Key_Error;
<font size=-1> 48</font>       <b><font color=#228B22>elsif</font></b> Key_Of (Element) = Key_Of (Tree.Info) <b><font color=#228B22>then</font></b>
<font size=-1> 49</font>          Tree.Info := Element;
<font size=-1> 50</font>       <b><font color=#228B22>elsif</font></b> Key_Of (Element) &#60; Key_Of (Tree.Info) <b><font color=#228B22>then</font></b>
<font size=-1> 51</font>          Modify (Tree =&#62; Tree.Left, Element =&#62; Element);
<font size=-1> 52</font>       <b><font color=#228B22>else</font></b>
<font size=-1> 53</font>          Modify (Tree =&#62; Tree.Right, Element =&#62; Element);
<font size=-1> 54</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1> 55</font>    <b><font color=#228B22>end</font></b> Modify;
<font size=-1> 56</font> 
<font size=-1> 57</font>    <b><font color=#228B22>function</font></b> Retrieve (Tree: Tree_Type;
<font size=-1> 58</font>                       Key :  Key_Type) <b><font color=#228B22>return</font></b> Element_Type <b><font color=#228B22>is</font></b>
<font size=-1> 59</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 60</font>       <b><font color=#228B22>if</font></b> Tree = <b><font color=#228B22>null</font></b> <b><font color=#228B22>then</font></b>
<font size=-1> 61</font>          <b><font color=#228B22>raise</font></b> Key_Error;
<font size=-1> 62</font>       <b><font color=#228B22>elsif</font></b> Key = Key_Of (Tree.Info) <b><font color=#228B22>then</font></b>
<font size=-1> 63</font>          <b><font color=#228B22>return</font></b> (Tree.Info);
<font size=-1> 64</font>       <b><font color=#228B22>elsif</font></b> Key &#60; Key_Of (Tree.Info) <b><font color=#228B22>then</font></b>
<font size=-1> 65</font>          <b><font color=#228B22>return</font></b> (Retrieve (Tree =&#62; Tree.Left, Key =&#62; Key));
<font size=-1> 66</font>       <b><font color=#228B22>else</font></b>
<font size=-1> 67</font>          <b><font color=#228B22>return</font></b> (Retrieve (Tree =&#62; Tree.Right, Key =&#62; Key));
<font size=-1> 68</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1> 69</font>    <b><font color=#228B22>end</font></b> Retrieve;
<font size=-1> 70</font> 
<font size=-1> 71</font> 
<font size=-1> 72</font>    <b><i><font color=#BB1212>-- Finds and unlinks the node with the maximum key from non-empty tree</font></i></b>
<font size=-1> 73</font>    <b><font color=#228B22>procedure</font></b> Find_And_Unlink_Max (Tree: <b><font color=#228B22>in</font></b> <b><font color=#228B22>out</font></b> Node_Ptr;
<font size=-1> 74</font>                                   Max :    <b><font color=#228B22>out</font></b> Element_Type) <b><font color=#228B22>is</font></b>
<font size=-1> 75</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 76</font>       <b><font color=#228B22>if</font></b> Tree.Right = <b><font color=#228B22>null</font></b> <b><font color=#228B22>then</font></b>  <b><i><font color=#BB1212>-- Is there a right child?</font></i></b>
<font size=-1> 77</font>          <b><i><font color=#BB1212>-- Root contains the maximum key in Tree</font></i></b>
<font size=-1> 78</font>          Max  := Tree.Info;
<font size=-1> 79</font>          Free (Tree);
<font size=-1> 80</font>          Tree := Tree.Left;   <b><i><font color=#BB1212>-- Replace root with left subtree</font></i></b>
<font size=-1> 81</font>       <b><font color=#228B22>else</font></b>
<font size=-1> 82</font>          <b><i><font color=#BB1212>-- Keep looking in the right subtree</font></i></b>
<font size=-1> 83</font>          Find_And_Unlink_Max (Tree =&#62; Tree.Right, Max =&#62; Max);
<font size=-1> 84</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1> 85</font>    <b><font color=#228B22>end</font></b> Find_And_Unlink_Max;
<font size=-1> 86</font> 
<font size=-1> 87</font> 
<font size=-1> 88</font>    <b><i><font color=#BB1212>-- This procedure deletes the root node from the given tree.</font></i></b>
<font size=-1> 89</font>    <b><font color=#228B22>procedure</font></b> Delete_Root (Tree : <b><font color=#228B22>in</font></b> <b><font color=#228B22>out</font></b> Tree_Type) <b><font color=#228B22>is</font></b>
<font size=-1> 90</font>       To_Recycle : Node_Ptr;  <b><i><font color=#BB1212>-- For recycling nodes</font></i></b>
<font size=-1> 91</font>    <b><font color=#228B22>begin</font></b>
<font size=-1> 92</font>       <b><font color=#228B22>if</font></b> Tree.Left = <b><font color=#228B22>null</font></b>  <b><font color=#228B22>and</font></b> Tree.Right = <b><font color=#228B22>null</font></b> <b><font color=#228B22>then</font></b>
<font size=-1> 93</font>          Free (Tree);                    <b><i><font color=#BB1212>-- Entire tree now empty</font></i></b>
<font size=-1> 94</font>       <b><font color=#228B22>elsif</font></b> Tree.Left = <b><font color=#228B22>null</font></b> <b><font color=#228B22>then</font></b>
<font size=-1> 95</font>          <b><i><font color=#BB1212>-- Root node has only a right child</font></i></b>
<font size=-1> 96</font>          To_Recycle := Tree;             <b><i><font color=#BB1212>-- Save for later deallocation</font></i></b>
<font size=-1> 97</font>          Tree := Tree.Right;             <b><i><font color=#BB1212>-- Unlink the root node</font></i></b>
<font size=-1> 98</font>          Free (To_Recycle);              <b><i><font color=#BB1212>-- Deallocate former root node</font></i></b>
<font size=-1> 99</font>       <b><font color=#228B22>elsif</font></b> Tree.Right = <b><font color=#228B22>null</font></b>  <b><font color=#228B22>then</font></b>
<font size=-1>100</font>          <b><i><font color=#BB1212>-- Root node has a left child</font></i></b>
<font size=-1>101</font>          To_Recycle := Tree;             <b><i><font color=#BB1212>-- Save for later deallocation</font></i></b>
<font size=-1>102</font>          Tree := Tree.Left;              <b><i><font color=#BB1212>-- Unlink the root node</font></i></b>
<font size=-1>103</font>          Free (To_Recycle);              <b><i><font color=#BB1212>-- Deallocate former root node</font></i></b>
<font size=-1>104</font>       <b><font color=#228B22>else</font></b>
<font size=-1>105</font>          <b><i><font color=#BB1212>-- Find and unlink the logical predecessor</font></i></b>
<font size=-1>106</font>          Find_And_Unlink_Max (Tree =&#62; Tree.Left, Max =&#62; Tree.Info);
<font size=-1>107</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1>108</font>    <b><font color=#228B22>end</font></b> Delete_Root;
<font size=-1>109</font> 
<font size=-1>110</font> 
<font size=-1>111</font>    <b><font color=#228B22>procedure</font></b> Delete (Tree : <b><font color=#228B22>in</font></b> <b><font color=#228B22>out</font></b> Tree_Type;
<font size=-1>112</font>                      Key  : <b><font color=#228B22>in</font></b>     Key_Type) <b><font color=#228B22>is</font></b>
<font size=-1>113</font>    <b><font color=#228B22>begin</font></b>
<font size=-1>114</font>       <b><font color=#228B22>if</font></b> Tree = <b><font color=#228B22>null</font></b> <b><font color=#228B22>then</font></b>
<font size=-1>115</font>          <b><font color=#228B22>raise</font></b> Key_Error;
<font size=-1>116</font>       <b><font color=#228B22>elsif</font></b> Key = Key_Of (Tree.Info) <b><font color=#228B22>then</font></b>
<font size=-1>117</font>          Delete_Root (Tree);
<font size=-1>118</font>       <b><font color=#228B22>elsif</font></b> Key &#60; Key_Of (Tree.Info) <b><font color=#228B22>then</font></b>
<font size=-1>119</font>          Delete (Tree =&#62; Tree.Left,  Key =&#62; Key);
<font size=-1>120</font>       <b><font color=#228B22>else</font></b>
<font size=-1>121</font>          Delete (Tree =&#62; Tree.Right, Key =&#62; Key);
<font size=-1>122</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1>123</font>    <b><font color=#228B22>end</font></b> Delete;
<font size=-1>124</font> 
<font size=-1>125</font>    <b><font color=#228B22>procedure</font></b> Traverse (Tree  : <b><font color=#228B22>in</font></b> <b><font color=#228B22>out</font></b> Tree_Type;
<font size=-1>126</font>                        Order : <b><font color=#228B22>in</font></b> Traversal_Order) <b><font color=#228B22>is</font></b>
<font size=-1>127</font> 
<font size=-1>128</font>       <b><font color=#228B22>procedure</font></b> Checked_Process (Element: <b><font color=#228B22>in</font></b> <b><font color=#228B22>out</font></b> Element_Type) <b><font color=#228B22>is</font></b>
<font size=-1>129</font>          New_Element: Element_Type := Element;
<font size=-1>130</font>       <b><font color=#228B22>begin</font></b>
<font size=-1>131</font>          Process (New_Element);
<font size=-1>132</font>          <b><font color=#228B22>if</font></b> Key_Of (Element) /= Key_Of (New_Element) <b><font color=#228B22>then</font></b>
<font size=-1>133</font>             <b><font color=#228B22>raise</font></b> Key_Error;
<font size=-1>134</font>          <b><font color=#228B22>else</font></b>
<font size=-1>135</font>             Element := New_Element;
<font size=-1>136</font>          <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1>137</font>       <b><font color=#228B22>end</font></b> Checked_Process;
<font size=-1>138</font> 
<font size=-1>139</font> 
<font size=-1>140</font>       <b><font color=#228B22>procedure</font></b> Inorder (Tree : <b><font color=#228B22>in</font></b> Tree_Type) <b><font color=#228B22>is</font></b>
<font size=-1>141</font>       <b><font color=#228B22>begin</font></b>
<font size=-1>142</font>          <b><font color=#228B22>if</font></b> Tree /= <b><font color=#228B22>null</font></b> <b><font color=#228B22>then</font></b>
<font size=-1>143</font>             Inorder (Tree =&#62; Tree.Left);    <b><i><font color=#BB1212>-- Traverse Left subtree</font></i></b>
<font size=-1>144</font>             Checked_Process (Tree.Info);
<font size=-1>145</font>             Inorder (Tree =&#62; Tree.Right);   <b><i><font color=#BB1212>-- Traverse Right subtree</font></i></b>
<font size=-1>146</font>          <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1>147</font>       <b><font color=#228B22>end</font></b> Inorder;
<font size=-1>148</font> 
<font size=-1>149</font>       <b><font color=#228B22>procedure</font></b> Preorder (Tree : <b><font color=#228B22>in</font></b> Tree_Type) <b><font color=#228B22>is</font></b>
<font size=-1>150</font>       <b><font color=#228B22>begin</font></b>
<font size=-1>151</font>          <b><font color=#228B22>if</font></b> Tree /= <b><font color=#228B22>null</font></b> <b><font color=#228B22>then</font></b>
<font size=-1>152</font>             Checked_Process (Tree.Info);
<font size=-1>153</font>             Preorder (Tree =&#62; Tree.Left);    <b><i><font color=#BB1212>-- Traverse Left subtree</font></i></b>
<font size=-1>154</font>             Preorder (Tree =&#62; Tree.Right);   <b><i><font color=#BB1212>-- Traverse Right subtree</font></i></b>
<font size=-1>155</font>          <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1>156</font>       <b><font color=#228B22>end</font></b> Preorder;
<font size=-1>157</font> 
<font size=-1>158</font>       <b><font color=#228B22>procedure</font></b> Postorder (Tree : <b><font color=#228B22>in</font></b> Tree_Type) <b><font color=#228B22>is</font></b>
<font size=-1>159</font>       <b><font color=#228B22>begin</font></b>
<font size=-1>160</font>          <b><font color=#228B22>if</font></b> Tree /= <b><font color=#228B22>null</font></b> <b><font color=#228B22>then</font></b>
<font size=-1>161</font>             Postorder (Tree =&#62; Tree.Left);    <b><i><font color=#BB1212>-- Traverse Left subtree</font></i></b>
<font size=-1>162</font>             Postorder (Tree =&#62; Tree.Right);   <b><i><font color=#BB1212>-- Traverse Right subtree</font></i></b>
<font size=-1>163</font>             Checked_Process (Tree.Info);
<font size=-1>164</font>          <b><font color=#228B22>end</font></b> <b><font color=#228B22>if</font></b>;
<font size=-1>165</font>       <b><font color=#228B22>end</font></b> Postorder;
<font size=-1>166</font> 
<font size=-1>167</font>    <b><font color=#228B22>begin</font></b> <b><i><font color=#BB1212>-- Traverse</font></i></b>
<font size=-1>168</font>       <b><font color=#228B22>case</font></b> Order <b><font color=#228B22>is</font></b>
<font size=-1>169</font>          <b><font color=#228B22>when</font></b> Inorder   =&#62; Inorder (Tree);
<font size=-1>170</font>          <b><font color=#228B22>when</font></b> Preorder  =&#62; Preorder (Tree);
<font size=-1>171</font>          <b><font color=#228B22>when</font></b> Postorder =&#62; Postorder (Tree);
<font size=-1>172</font>       <b><font color=#228B22>end</font></b> <b><font color=#228B22>case</font></b>;
<font size=-1>173</font>    <b><font color=#228B22>end</font></b> Traverse;
<font size=-1>174</font> 
<font size=-1>175</font> <b><font color=#228B22>end</font></b> Binary_Search_Tree;
</pre>
</body>
</html>
